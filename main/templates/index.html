<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic KG RAG Explorer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <div id="status-bar">âœ¨ 29,873 Documents</div>
    <h1>Query Documents</h1>

    <form id="query-form">
        <div class="form-section">
            <div class="input-container">
                <input type="text" id="query-input" placeholder=" " autocomplete="off">
                <label for="query-input" class="input-label">Enter your query...</label>
            </div>
            <div class="slider-container">
                <label class="slider-label" for="k-slider">
                    Number of Documents to Retrieve: <span id="k-value-label">10</span>
                </label>
                <input type="range" id="k-slider" min="1" max="20" value="10">
            </div>
        </div>
        <button type="submit" id="query-btn">Generate Answer</button>
    </form>
    
    <div id="loader" class="loader"></div>
    <div id="error-container"></div>

    <div id="answer-container">
        <h2>Generated Answer (from MongoDB RAG)</h2>
        <p id="answer-text"></p>
    </div>

    <div id="docs-container"></div>

    <section id="graph-section">
        <div class="graph-header">
            <h2>Retrieved Knowledge Graph</h2>
            <button id="export-graph">Export as PNG</button>
        </div>
        <div id="graph-container"></div>
    </section>

    <section id="comparison-section">
        <button id="compare-btn">Compare RAG Approaches</button>
        <div id="comparison-loader" class="loader"></div>
        <div id="comparison-results-container" style="display: none;">
            <h2>Answer Comparison</h2>
            <div class="comparison-grid">
                
                <!-- Plain LLM Column -->
                <div class="comparison-column">
                    <h3>Plain LLM</h3>
                    <p id="plain-llm-answer"></p>
                    <div class="automated-metrics">
                        <h4>Automated Metrics</h4>
                        <div class="metric-item"><span class="metric-label">BLEU Score:</span><span class="metric-value" id="plain-llm-bleu">N/A</span></div>
                        <div class="metric-item"><span class="metric-label">ROUGE-L:</span><span class="metric-value" id="plain-llm-rouge">N/A</span></div>
                    </div>
                    <form class="feedback-form" data-model="plain_llm" onsubmit="return false;">
                        <h4>Your Rating</h4>
                        <div class="rating-group"><label>Factual Accuracy</label><div class="stars" data-metric="accuracy"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Completeness</label><div class="stars" data-metric="completeness"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Coherence</label><div class="stars" data-metric="coherence"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Helpfulness</label><div class="stars" data-metric="helpfulness"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <button type="button" class="submit-feedback-btn">Submit Rating</button>
                    </form>
                </div>

                <!-- MongoDB RAG Column -->
                <div class="comparison-column">
                    <h3>MongoDB RAG</h3>
                    <p id="mongodb-rag-answer"></p>
                    <div class="automated-metrics">
                        <h4>Automated Metrics</h4>
                        <div class="metric-item"><span class="metric-label">BLEU Score:</span><span class="metric-value" id="mongodb-rag-bleu">N/A</span></div>
                        <div class="metric-item"><span class="metric-label">ROUGE-L:</span><span class="metric-value" id="mongodb-rag-rouge">N/A</span></div>
                    </div>
                    <form class="feedback-form" data-model="mongodb_rag" onsubmit="return false;">
                        <h4>Your Rating</h4>
                        <div class="rating-group"><label>Factual Accuracy</label><div class="stars" data-metric="accuracy"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Completeness</label><div class="stars" data-metric="completeness"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Coherence</label><div class="stars" data-metric="coherence"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Helpfulness</label><div class="stars" data-metric="helpfulness"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <button type="button" class="submit-feedback-btn">Submit Rating</button>
                    </form>
                </div>

                <!-- Neo4j KG RAG Column -->
                <div class="comparison-column">
                    <h3>Neo4j KG RAG</h3>
                    <p id="neo4j-kg-rag-answer"></p>
                     <div class="automated-metrics">
                        <h4>Automated Metrics</h4>
                        <div class="metric-item"><span class="metric-label">BLEU Score:</span><span class="metric-value" id="neo4j-kg-rag-bleu">N/A</span></div>
                        <div class="metric-item"><span class="metric-label">ROUGE-L:</span><span class="metric-value" id="neo4j-kg-rag-rouge">N/A</span></div>
                    </div>
                    <form class="feedback-form" data-model="neo4j_kg_rag" onsubmit="return false;">
                        <h4>Your Rating</h4>
                        <div class="rating-group"><label>Factual Accuracy</label><div class="stars" data-metric="accuracy"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Completeness</label><div class="stars" data-metric="completeness"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Related to Data</label><div class="stars" data-metric="coherence"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <div class="rating-group"><label>Helpfulness</label><div class="stars" data-metric="helpfulness"><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span><span>&#9733;</span></div></div>
                        <button type="button" class="submit-feedback-btn">Submit Rating</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>

